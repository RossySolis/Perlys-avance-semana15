---
import Layout from '../layouts/Layout.astro';
import Footer from '../components/footer.astro';
import '../styles/estilos.css';
import { supabase } from '../lib/supabase.ts';

let { data: productos, error } = await supabase
  .from('productos')
  .select('*')
  .order('created_at', { ascending: false });
---

<Layout>

  <!-- Hero principal -->
  <header class="hero relative h-[450px] overflow-hidden" id="inicio">
    <div class="absolute top-0 left-0 w-full h-full overflow-hidden z-0">
      <img src="/img/perlys.jpg" alt="Moda Infantil" class="w-full h-full object-cover filter brightness-85">
    </div>

    <div class="hero-content relative text-center mx-auto max-w-lg z-10 text-pink-700 pt-[140px]">
      <h1 class="text-4xl md:text-5xl font-bold">Perlyâ€™s</h1>
      <h2 class="text-xl md:text-2xl">Moda actualizada para niÃ±as</h2>
      <p class="text-base md:text-lg">Todo lo que buscas en un solo lugar</p>
      <a href="#productos" class="inline-block mt-3 bg-pink-600 text-white py-2 px-5 rounded-full hover:bg-pink-700 transition-colors">
        Ver productos
      </a>
    </div>
  </header>

  <!-- SecciÃ³n de productos -->
  <section id="productos" class="productos text-center py-10 bg-pink-50">
    <h2 class="text-2xl md:text-3xl font-semibold text-pink-700 mb-8">âœ¨ Top Productos de Perly's âœ¨</h2>
    <div class="container mx-auto px-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-6">

      {productos?.map(producto => (
        <div class="card shadow-lg rounded-2xl overflow-hidden h-full">
          {producto.image_url ? (
            <img src={producto.image_url} class="w-full h-64 object-cover" alt={producto.nombre} />
          ) : (
            <div class="w-full h-64 bg-gray-200 flex items-center justify-center">No image</div>
          )}
          <div class="p-4 text-left">
            <h3 class="font-semibold text-lg">{producto.nombre}</h3>
            <p>S/{producto.precio}</p>
            <button class="mt-2 bg-pink-600 text-white py-1 px-4 rounded-full hover:bg-pink-700 transition-colors">
              Agregar al carrito
            </button>
          </div>
        </div>
      ))}

    </div>
  </section>

  <!-- Carrito flotante -->
  <div id="cart" class="fixed top-20 right-5 w-80 bg-white shadow-lg p-4 rounded hidden z-50">
    <h3 class="text-lg font-bold mb-2">Carrito</h3>
    <div id="cart-items" class="space-y-2"></div>
    <div class="mt-4 font-semibold">Total: S/<span id="cart-total">0.00</span></div>
    <button id="close-cart" class="mt-3 w-full bg-red-500 text-white py-1 rounded hover:bg-red-600 transition-colors">
      Cerrar
    </button>
  </div>

  <!-- BotÃ³n flotante para abrir el carrito -->
  <button id="open-cart" class="fixed bottom-5 right-5 bg-pink-600 text-white p-3 rounded-full shadow-lg hover:bg-pink-700 transition-colors">
    ðŸ›’
  </button>

  <!-- PromociÃ³n -->
  <section class="promo text-center py-10 bg-purple-100 text-purple-800">
    <h2 class="text-2xl font-semibold">ðŸŒ¸ 20% de descuento en tu primer pedido ðŸŒ¸</h2>
    <p class="mt-2">Â¡Aprovecha nuestra promociÃ³n especial y vÃ­stelas con ternura y estilo!</p>
    <a href="/pedidos" class="inline-block mt-3 bg-pink-600 text-white py-2 px-5 rounded-full hover:bg-pink-700 transition-colors">
      Pedir ahora
    </a>
  </section>

<Footer />

</Layout>
